# 会说话的文物系统 - 运行说明文档

## 📋 项目概述

**会说话的文物**是一个基于AI技术的文化遗产展示系统，通过大语言模型(LLM)和知识图谱技术，让文物能够"开口说话"，为观众提供个性化的交互式导览体验。

### 🎯 主要功能
- **AI文物对话**: 文物角色扮演，支持不同观众群体（儿童/学者/游客）
- **视频生成**: 文本转视频功能，支持多种艺术风格
- **全息展示**: 赛博朋克风格的Web界面
- **知识图谱**: 文物间关系展示和智能推理

---

## 🚀 本地运行方法

### 1. 环境准备

#### 系统要求
- **操作系统**: Windows 10/11, macOS, Linux
- **Python版本**: 3.8 或更高版本
- **浏览器**: Chrome, Firefox, Safari (推荐Chrome)

#### 安装Python依赖
```bash
# 安装requests库（用于API调用）
pip install requests

# 如果没有pip，可以使用以下命令安装
python -m pip install requests
```

### 2. 启动服务器

#### 方法一：直接运行Python文件
```bash
# 在项目根目录下执行
python integrated_backend2.py
```

#### 方法二：使用Python模块方式
```bash
python -m integrated_backend2
```

### 3. 访问系统

服务器启动后，你会看到类似以下输出：
```
============================================================
🚀 [旗舰演示版] 服务器已启动: http://localhost:8000
💬 对话引擎: DeepSeek-V3 (Real API)
🎬 视频引擎: 定向映射模式 (输入'大足石刻' -> 播放 2.mp4)
============================================================
```

**访问地址**: 在浏览器中打开 `http://localhost:8000`

---

## 🌐 使用cpolar实现外网访问

### 1. 安装cpolar

#### Windows系统
1. 访问 [cpolar官网](https://www.cpolar.com/) 下载Windows客户端
2. 安装并注册账号
3. 启动cpolar客户端

#### macOS/Linux系统
```bash
# 下载并安装cpolar
curl -L https://www.cpolar.com/static/downloads/install-release-cpolar.sh | sudo bash

# 或者使用包管理器
# macOS (使用Homebrew)
brew install cpolar

# Ubuntu/Debian
sudo apt-get install cpolar
```

### 2. 配置cpolar隧道

#### 方法一：使用cpolar Web界面
1. 启动cpolar: `cpolar http 8000`
2. 打开cpolar管理界面: `http://localhost:9200`
3. 在"隧道管理"中添加新隧道：
   - **隧道名称**: talking-relics
   - **协议**: http
   - **本地地址**: 8000
   - **域名类型**: 随机域名（免费）或自定义域名（付费）

#### 方法二：使用命令行
```bash
# 创建HTTP隧道，将本地8000端口映射到公网
cpolar http 8000

# 或者指定子域名（需要付费账户）
cpolar http -subdomain=my-talking-relics 8000
```

### 3. 获取公网访问地址

启动cpolar后，你会看到类似输出：
```
Web Interface                 http://127.0.0.1:9200
Forwarding                    http://abc123.cpolar.cn -> http://localhost:8000
Forwarding                    https://abc123.cpolar.cn -> http://localhost:8000
```

**公网访问地址**: `https://abc123.cpolar.cn`（地址会随机生成）

---

## 📱 多设备访问指南

### 1. 同一局域网访问
如果设备在同一WiFi网络下：
```
# 查看本机IP地址
# Windows: ipconfig
# macOS/Linux: ifconfig 或 ip addr

# 假设本机IP为192.168.1.100，其他设备可访问：
http://192.168.1.100:8000
```

### 2. 外网设备访问
使用cpolar生成的公网地址，任何有网络的设备都可以访问：
- **手机**: 直接在浏览器输入cpolar地址
- **平板**: 同手机操作
- **其他电脑**: 在任何浏览器输入cpolar地址

### 3. 移动端优化
系统已针对手机端进行优化：
- 响应式布局，自动适配屏幕尺寸
- 触摸友好的交互设计
- 垂直滚动布局，适合手机操作

---

## 🔧 系统配置说明

### 1. API配置
系统使用SiliconFlow API提供AI对话功能：
```python
# 在integrated_backend2.py中配置
API_KEY = "sk-icmlygwecglrkvlnehccofuzdpqpksxhlmqsuzqqeteagsbn"
```

### 2. 视频文件配置
系统支持本地视频播放，视频文件存放在`output`目录：
```
output/
├── 1.mp4  # 青铜鼎视频
├── 2.mp4  # 大足石刻视频
└── 3.mp4  # 三星堆视频
```

### 3. 图片资源配置
文物图片存放在`images`目录：
```
images/
├── 1.jpg  # 青铜鼎图片
├── 2.jpg  # 大足石刻图片
└── 3.jpg  # 三星堆图片
```

---

## 🎮 使用教程

### 1. 文物对话功能
1. 选择左侧文物列表中的任一文物
2. 在右侧选择观众类型（儿童/学者/游客）
3. 选择对话模式（拟人化/讲解员）
4. 输入问题或直接点击"启动对话"
5. 查看AI生成的个性化回复

### 2. 视频生成功能
1. 切换到"视频生成"标签页
2. 输入想要转换的文本内容
3. 配置视频参数（风格、时长、分辨率等）
4. 选择主色调
5. 点击"生成彩色视频"按钮
6. 等待生成完成并预览结果

### 3. 团队信息查看
- 切换到"人员档案"标签页查看项目团队信息

---

## ⚠️ 常见问题解决

### 1. 服务器启动失败
```bash
# 检查端口是否被占用
netstat -ano | findstr :8000  # Windows
lsof -i :8000                 # macOS/Linux

# 更换端口（修改integrated_backend2.py中的PORT变量）
PORT = 8001
```

### 2. API调用失败
- 检查网络连接
- 确认API密钥有效
- 查看控制台错误信息

### 3. cpolar连接问题
```bash
# 重启cpolar服务
cpolar stop
cpolar start

# 检查cpolar状态
cpolar status
```

### 4. 移动端显示问题
- 确保使用现代浏览器（Chrome、Safari等）
- 清除浏览器缓存
- 检查网络连接稳定性

---

## 🔒 安全注意事项

### 1. API密钥保护
- 不要将API密钥提交到公共代码仓库
- 定期更换API密钥
- 监控API使用量

### 2. 网络安全
- cpolar隧道仅用于开发测试
- 生产环境建议使用专业的云服务
- 注意防火墙设置

### 3. 访问控制
- 可以在代码中添加访问限制
- 监控异常访问行为

---

## 📞 技术支持

### 项目团队联系方式
- **项目负责人**: 陈浩
- **核心开发**: 张铭泽、祁美文
- **GitHub**: [项目仓库地址]

### 常用资源链接
- [cpolar官方文档](https://www.cpolar.com/docs)
- [SiliconFlow API文档](https://siliconflow.cn/docs)
- [Python官方文档](https://docs.python.org/)

---

## 🎉 结语

通过以上步骤，你就可以成功运行"会说话的文物"系统，并让其他设备通过网络访问。系统结合了AI对话、视频生成和文化展示功能，为用户提供了沉浸式的文物交互体验。

如果在使用过程中遇到问题，请参考常见问题解决部分，或联系项目团队获取技术支持。

**祝你使用愉快！** 🚀